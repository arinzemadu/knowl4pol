<?xml version="1.0" encoding="UTF-8" ?>
<project name="My subsite" default="help">

    <target
        name="build-europa-theme"
        description="Downloads Europa theme and creates symlink.">

        <phingcall target="process-europa-theme" />
    </target>

    <!-- This step in future will become a part of a build on the new Europa theme repository. -->
    <target name="process-europa-theme">
        <!-- Download the Europa theme archive for a given branch. -->
        <exec
            command="curl -L https://github.com/ec-europa/ec_europa/releases/download/${ec_europa.version}/ec_europa-${ec_europa.version}.tar.gz > ${subsite.resources.themes.dir}/ec_europa.tar.gz"
            passthru="true" />
        <!-- Extract the archive -->
        <mkdir dir="${subsite.resources.themes.dir}/ec_europa" />
        <exec
            dir="${subsite.resources.themes.dir}"
            command="tar xzf ec_europa.tar.gz --strip=1 -C ec_europa"
            passthru="true" />
        <delete file="${subsite.resources.themes.dir}/ec_europa.tar.gz" quiet="true" />
        <phingcall target="embed-ecl-assets" />
    </target>

    <target name="embed-ecl-assets">
        <!-- Download the ECL release package. -->
        <exec
            command="curl -L https://github.com/ec-europa/europa-component-library/releases/download/${ecl.version}/framework.tar.gz > ${subsite.resources.themes.dir}/ec_europa/framework.tar.gz"
            passthru="true" />
        <!-- Extract and embed the ECL artifacts into the Europa theme. -->
        <exec
            dir="${subsite.resources.themes.dir}/ec_europa"
            command="tar xzf framework.tar.gz --strip=1 -C assets"
            passthru="true" />
        <delete file="${subsite.resources.themes.dir}/ec_europa/framework.tar.gz" quiet="true" />
    </target>

</project>
